"use strict";(self.webpackChunkmcp_ai=self.webpackChunkmcp_ai||[]).push([[1869],{1305:e=>{e.exports=JSON.parse('{"permalink":"/mcp-threats-prompt-injection","source":"@site/blog/mcp-threats-prompt-injection.md","title":"MCP Threats and Misleadings - Prompt Injection","description":"An overview of threats and misleadings related to prompt injection in the context of MCP (Model Context Protocol).","date":"2025-10-08T11:36:31.000Z","tags":[{"inline":false,"label":"MCP","permalink":"/tags/mcp","description":"MCP is an open protocol for connecting LLM apps to external data sources and tools, enabling seamless integration and interoperability.\\n"},{"inline":false,"label":"Security","permalink":"/tags/security","description":"Security involves protecting systems, networks, and data from digital attacks, unauthorized access, and damage\\n"}],"readingTime":3.15,"hasTruncateMarker":true,"authors":[{"name":"Adrian Escutia","title":"La Rebelion Founder","url":"https://adrian.escutia.me","page":{"permalink":"/authors/adrian"},"socials":{"x":"https://x.com/ades_mx","linkedin":"https://www.linkedin.com/in/adrianescutia/","github":"https://github.com/adrianescutia","newsletter":"https://rebelion.la"},"bio":"Adrian is the founder of La Rebelion, a newsletter about AI, technology, and the future. He is also a software engineer and entrepreneur.","imageURL":"https://github.com/adrianescutia.png","key":"adrian"}],"frontMatter":{"title":"MCP Threats and Misleadings - Prompt Injection","description":"An overview of threats and misleadings related to prompt injection in the context of MCP (Model Context Protocol).","authors":["adrian"],"tags":["mcp","security"],"image":"https://cdn.gamma.app/z3n406kubdfbysb/generated-images/trv8ZioPQIQ84iK46Bd8B.png"},"unlisted":false,"prevItem":{"title":"OpenAI SDK Meets MCP (Model Context Protocol)","permalink":"/openai-meets-mcp"},"nextItem":{"title":"Swagger/OAS v4 Is out","permalink":"/oas-v4-is-out"}}')},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var i=t(6540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}},8827:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var i=t(1305),s=t(4848),r=t(8453);const o={title:"MCP Threats and Misleadings - Prompt Injection",description:"An overview of threats and misleadings related to prompt injection in the context of MCP (Model Context Protocol).",authors:["adrian"],tags:["mcp","security"],image:"https://cdn.gamma.app/z3n406kubdfbysb/generated-images/trv8ZioPQIQ84iK46Bd8B.png"},a="MCP Threats and Prompt Injection: What You Must Know",l={authorsImageUrls:[void 0]},c=[{value:"Introduction",id:"introduction",level:2},{value:"How Prompt Injection Works in MCP",id:"how-prompt-injection-works-in-mcp",level:2},{value:"Threats",id:"threats",level:2},{value:"Common Misleadings",id:"common-misleadings",level:2},{value:"Mitigation Strategies",id:"mitigation-strategies",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",admonition:"admonition",h2:"h2",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Prompt injection is a critical security risk for any system using large language models (LLMs), including those built with Model Context Protocol (MCP). You must understand how prompt injection works, why MCP cannot prevent it, and what steps you should take to protect your users and applications (MCP Clients)."}),"\n",(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsx)(n.p,{children:"MCP enables users and clients to discover and pull prompts from MCP Servers. This flexibility means you, as a client developer, are responsible for validating and sanitizing all user inputs before they reach the LLM. MCP Clients act as intermediaries between MCP Servers, end users, and LLMs. If you do not implement proper validation, malicious prompts can reach the LLM and cause harmful or unintended outputs."}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsxs)(n.p,{children:["Prompt injection is recognized as a top risk by OpenAI (",(0,s.jsx)(n.a,{href:"https://platform.openai.com/docs/guides/prompt-injection",children:"OpenAI Prompt Injection Guide"}),"), Anthropic (",(0,s.jsx)(n.a,{href:"https://www.anthropic.com/index/prompt-injection",children:"Anthropic Prompt Injection FAQ"}),"), and OWASP (",(0,s.jsx)(n.a,{href:"https://owasp.org/www-project-top-10-for-large-language-model-applications/",children:"OWASP AI Security Top 10"}),")."]})}),"\n",(0,s.jsx)(n.h2,{id:"how-prompt-injection-works-in-mcp",children:"How Prompt Injection Works in MCP"}),"\n",(0,s.jsx)(n.mermaid,{value:"flowchart RL\n  A[Client Developer] --\x3e|Builds| E[MCP Client]\n  E --\x3e|Connects to| B[MCP Server]\n  B --\x3e|Serves Prompts| E\n  E --\x3e|Delivers Prompts| C[End User]\n  C --\x3e|Inputs/Queries| E\n  E --\x3e|Forwards Inputs| D[LLM]\n  D --\x3e|Generates Responses| E\n  E --\x3e|Returns Responses| C\n  B --\x3e|Provides Prompts| E\n  subgraph Perspectives\n    E\n    C\n    D\n  end"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Roles:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Client Developer:"})," You build MCP Clients and must implement security and validation."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"MCP Client:"})," Your app acts as an intermediary, handling prompt delivery and user input forwarding."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"End User:"})," Users interact with LLMs via MCP Clients and may provide inputs that could be exploited."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"LLM:"})," Processes prompts and user inputs, vulnerable to prompt injection if upstream validation is insufficient."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"threats",children:"Threats"}),"\n",(0,s.jsx)(n.p,{children:"Prompt injection can lead to several serious risks:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Malicious Prompts:"})," Attackers craft prompts to manipulate the LLM into generating harmful or unintended outputs (",(0,s.jsx)(n.a,{href:"https://platform.openai.com/docs/guides/prompt-injection",children:"OpenAI"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"User Input Manipulation:"})," End users may input data designed to exploit vulnerabilities in the LLM's response generation (",(0,s.jsx)(n.a,{href:"https://www.anthropic.com/index/prompt-injection",children:"Anthropic"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Data Leakage:"})," Sensitive information may be exposed through manipulated prompts or responses (",(0,s.jsx)(n.a,{href:"https://airmf.nist.gov/",children:"NIST AI RMF"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Reputation Damage:"})," Misleading outputs generated by LLMs due to prompt injection can harm your application's reputation."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"common-misleadings",children:"Common Misleadings"}),"\n",(0,s.jsx)(n.p,{children:"Avoid these misconceptions:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"False Sense of Security:"})," MCP does not provide inherent protection against prompt injection. You must implement your own safeguards."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Overreliance on LLMs:"})," LLMs do not automatically handle all types of inputs safely. Validation is essential."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Misunderstanding Roles:"})," Security measures must be implemented in the MCP Client, not just the server or LLM."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Assumption of Trustworthiness:"})," Do not trust all prompts from third-party MCP Servers. Use official or self-hosted servers when possible (",(0,s.jsx)(n.a,{href:"https://owasp.org/www-project-top-10-for-large-language-model-applications/",children:"OWASP"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Neglecting Client Responsibility:"})," Input validation is your responsibility as the MCP Client developer."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"mitigation-strategies",children:"Mitigation Strategies"}),"\n",(0,s.jsx)(n.p,{children:"Follow these best practices to reduce prompt injection risks:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Input Validation:"})," Check all user inputs for malicious content before forwarding to the LLM (",(0,s.jsx)(n.a,{href:"https://owasp.org/www-project-top-10-for-large-language-model-applications/",children:"OWASP"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Sanitization:"})," Remove or neutralize potentially harmful elements in user inputs."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"User Education:"})," Inform users about prompt injection risks and safe input practices."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Regular Audits:"})," Audit your MCP Client regularly to identify and fix vulnerabilities."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Monitoring and Logging:"})," Track interactions and flag suspicious activities for review."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://platform.openai.com/docs/guides/prompt-injection",children:"OpenAI: Prompt Injection Guide"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.anthropic.com/index/prompt-injection",children:"Anthropic: Prompt Injection FAQ"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://owasp.org/www-project-top-10-for-large-language-model-applications/",children:"OWASP: Top 10 for LLM Applications"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://airmf.nist.gov/",children:"NIST: AI Risk Management Framework"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"By understanding and addressing these threats, you can secure your MCP Client against prompt injection vulnerabilities and protect your users and reputation."})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);