"use strict";(self.webpackChunkmcp_ai=self.webpackChunkmcp_ai||[]).push([[5309],{7277:e=>{e.exports=JSON.parse('{"permalink":"/mcp-at-scale/how-to-scale-mcp-to-thousands-of-tools-without-distroying-budget","source":"@site/blog/mcp-at-scale/how-to-scale-mcp-to-thousands-of-tools-without-distroying-budget.mdx","title":"How to Scale MCP to Thousands of Tools Without Destroying Your Budget","description":"Strategies to manage token bloat in MCP systems as tool catalogs grow.","date":"2026-01-19T18:49:49.000Z","tags":[{"inline":false,"label":"MCP at Scale","permalink":"/tags/mcp-at-scale","description":"MCP at Scale refers to the implementation and management of the Model Context Protocol in large-scale environments, ensuring performance, reliability, and security for extensive AI applications.\\n"},{"inline":false,"label":"Architecture","permalink":"/tags/architecture","description":"The structural design and organization of systems, components, and their interactions within a software or hardware environment.\\n"}],"readingTime":11.41,"hasTruncateMarker":true,"authors":[{"name":"Adrian Escutia","title":"La Rebelion Founder","url":"https://adrian.escutia.me","page":{"permalink":"/authors/adrian"},"socials":{"x":"https://x.com/ades_mx","linkedin":"https://www.linkedin.com/in/adrianescutia/","github":"https://github.com/adrianescutia","newsletter":"https://rebelion.la"},"bio":"Adrian is the founder of La Rebelion, a newsletter about AI, technology, and the future. He is also a software engineer and entrepreneur.","imageURL":"https://github.com/adrianescutia.png","key":"adrian"}],"frontMatter":{"title":"How to Scale MCP to Thousands of Tools Without Destroying Your Budget","description":"Strategies to manage token bloat in MCP systems as tool catalogs grow.","keywords":["MCP Scaling","Token Bloat","AI Platform Design","MCP token optimization","HAPI MCP","Tool Discovery"],"tags":["mcp-at-scale","architecture"],"authors":["adrian"],"image":"/img/blog/dynamic-discovery-tools.png"},"unlisted":false,"prevItem":{"title":"MCP at Scale: Engineering the Future of AI Platforms","permalink":"/mcp-at-scale"},"nextItem":{"title":"Unlocking Podcast Insights with MCP","permalink":"/lenny-rachitsky-podcast-mcp-server"}}')},7552:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,faqJsonLd:()=>d,frontMatter:()=>r,metadata:()=>t,toc:()=>h});var t=s(7277),i=s(4848),o=s(8453),l=s(5260);const r={title:"How to Scale MCP to Thousands of Tools Without Destroying Your Budget",description:"Strategies to manage token bloat in MCP systems as tool catalogs grow.",keywords:["MCP Scaling","Token Bloat","AI Platform Design","MCP token optimization","HAPI MCP","Tool Discovery"],tags:["mcp-at-scale","architecture"],authors:["adrian"],image:"/img/blog/dynamic-discovery-tools.png"},a=void 0,c={authorsImageUrls:[void 0]},d={"@context":"https://schema.org","@type":"FAQPage",mainEntity:[{"@type":"Question",name:"What is token bloat in MCP?",acceptedAnswer:{"@type":"Answer",text:"Token bloat in MCP happens when an MCP client injects too many tool definitions (schemas + descriptions) into the model context, inflating prompt size before reasoning even starts."}},{"@type":"Question",name:"Why is token bloat a problem for MCP systems?",acceptedAnswer:{"@type":"Answer",text:"Token bloat increases cost per request, adds latency, degrades tool selection quality, and expands the security/compliance surface because more tools appear in context than are needed."}},{"@type":"Question",name:"What causes token bloat in MCP tool catalogs?",acceptedAnswer:{"@type":"Answer",text:"The most common cause is static tool injection: loading the full tool catalog into the prompt on every request instead of discovering and loading only what\u2019s needed."}},{"@type":"Question",name:"What is lazy loading for MCP tools?",acceptedAnswer:{"@type":"Answer",text:"Lazy loading means you load tool schemas only after the agent has identified relevant tools (usually via search/ranking), rather than preloading every tool into context."}},{"@type":"Question",name:"What is tool discovery in MCP?",acceptedAnswer:{"@type":"Answer",text:"Tool discovery is a step where the agent queries a registry (or authority layer) to retrieve a small, ranked set of candidate tools for a task, then loads only those."}},{"@type":"Question",name:"How do you mitigate token bloat when you have thousands of MCP tools?",acceptedAnswer:{"@type":"Answer",text:"Use search-based discovery + ranking, enforce tool/context budgets, filter tools by policy (role/tenant), and expand schemas on demand (summaries first, full schemas later)."}},{"@type":"Question",name:"What is a context budget for MCP tools?",acceptedAnswer:{"@type":"Answer",text:"A context budget is a hard limit on how many tools or schema tokens can be included in a request. It keeps cost and latency predictable and prevents runaway prompts."}},{"@type":"Question",name:"Should I use FAQPage or QAPage schema for MCP Q&A content?",acceptedAnswer:{"@type":"Answer",text:"Use FAQPage when each question has a single authoritative answer you provide. Use QAPage only when users can submit answers (like forums)."}},{"@type":"Question",name:"What is shadow MCP and how does it relate to token bloat?",acceptedAnswer:{"@type":"Answer",text:"Shadow MCP is ungoverned MCP tooling (servers/tools) that appear without centralized discovery, policy, or audit. It often shows up first as tool sprawl and token bloat."}},{"@type":"Question",name:"What\u2019s the best MCP architecture pattern to scale tool catalogs?",acceptedAnswer:{"@type":"Answer",text:"Registry-first discovery with an authority/policy layer: the agent searches a catalog, gets a small ranked shortlist, and only then loads the selected tool schemas for execution."}}]},h=[{value:"Token Bloat in MCP: Why Your Tool Catalog Is Becoming a Cost, Latency, and Security Problem",id:"token-bloat-in-mcp-why-your-tool-catalog-is-becoming-a-cost-latency-and-security-problem",level:2},{value:"Business impact first",id:"business-impact-first",level:3},{value:"What Is Token Bloat in MCP?",id:"what-is-token-bloat-in-mcp",level:3},{value:"Simple definition",id:"simple-definition",level:4},{value:"Why MCP Is Uniquely Vulnerable?",id:"why-mcp-is-uniquely-vulnerable",level:3},{value:"MCP encourages tool catalogs",id:"mcp-encourages-tool-catalogs",level:4},{value:"The Breaking Point: Thousands of Tools",id:"the-breaking-point-thousands-of-tools",level:4},{value:"Claude\u2019s Tool Search Tool: The New MCP Pattern",id:"claudes-tool-search-tool-the-new-mcp-pattern",level:2},{value:"The Core MCP Scaling Problem",id:"the-core-mcp-scaling-problem",level:2},{value:"SEP-1576: The Community\u2019s Wake-Up Call",id:"sep-1576-the-communitys-wake-up-call",level:3},{value:"Why Token Bloat Breaks AI Reasoning",id:"why-token-bloat-breaks-ai-reasoning",level:3},{value:"MCP Needs Platform Architecture \u2014 Not Just Protocols",id:"mcp-needs-platform-architecture--not-just-protocols",level:2},{value:"Shadow MCP: The Silent Compliance Risk",id:"shadow-mcp-the-silent-compliance-risk",level:2},{value:"Best Practices for Token-Efficient MCP Design",id:"best-practices-for-token-efficient-mcp-design",level:2},{value:"1. Never Load All Tools",id:"1-never-load-all-tools",level:3},{value:"2. Implement Tool Discovery",id:"2-implement-tool-discovery",level:3},{value:"3. Use Tool Summaries First",id:"3-use-tool-summaries-first",level:3},{value:"4. Enforce Context Budgets",id:"4-enforce-context-budgets",level:3},{value:"5. Add Policy-Based Tool Filtering",id:"5-add-policy-based-tool-filtering",level:3},{value:"6. Add Tool Ranking",id:"6-add-tool-ranking",level:3},{value:"7. Add Tool Versioning",id:"7-add-tool-versioning",level:3},{value:"8. Use Partial Schemas",id:"8-use-partial-schemas",level:3},{value:"9. Add Audit Trails",id:"9-add-audit-trails",level:3},{value:"MCP Is Becoming an AI Operating System",id:"mcp-is-becoming-an-ai-operating-system",level:2},{value:"Where HAPI MCP Fits in This Architecture",id:"where-hapi-mcp-fits-in-this-architecture",level:2},{value:"The Future: Tool Search, Lazy Loading, and AI Gateways",id:"the-future-tool-search-lazy-loading-and-ai-gateways",level:2},{value:"Final Takeaways: How to Build MCP Systems That Scale",id:"final-takeaways-how-to-build-mcp-systems-that-scale",level:2},{value:"MCP Without Token Discipline Will Fail",id:"mcp-without-token-discipline-will-fail",level:2},{value:"The question is simple:",id:"the-question-is-simple",level:2},{value:"FAQ: Token bloat in MCP",id:"faq-token-bloat-in-mcp",level:2},{value:"References:",id:"references",level:2}];function x(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.A,{children:(0,i.jsx)("script",{type:"application/ld+json",children:JSON.stringify(d)})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Your MCP just became a memory hog. And it\u2019s quietly burning your budget."})}),"\n",(0,i.jsxs)(n.p,{children:["If your Model Context Protocol (MCP) catalog is growing into the hundreds\u2014or thousands\u2014of tools, you\u2019re already facing the next invisible scalability wall: ",(0,i.jsx)(n.strong,{children:"token bloat"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"And it\u2019s not a theory anymore."}),"\n",(0,i.jsxs)(n.p,{children:["Claude shipped its ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"https://platform.claude.com/docs/en/agents-and-tools/tool-use/tool-search-tool",children:"Tool Search Tool"})})," \u2014 a long-requested feature that dynamically discovers and loads tools on demand. The MCP community is actively debating ",(0,i.jsx)(n.a,{href:"https://github.com/modelcontextprotocol/modelcontextprotocol/issues/1978",children:(0,i.jsx)(n.strong,{children:"lazy loading"})}),", ",(0,i.jsx)(n.a,{href:"https://github.com/modelcontextprotocol/modelcontextprotocol/issues/1881",children:(0,i.jsx)(n.strong,{children:"dynamic discovery"})}),", and ",(0,i.jsx)(n.strong,{children:"context minimization"}),". There\u2019s even a formal proposal now:\n\ud83d\udc49 ",(0,i.jsx)(n.a,{href:"https://github.com/modelcontextprotocol/modelcontextprotocol/issues/1576",children:(0,i.jsx)(n.strong,{children:"SEP-1576: Mitigating Token Bloat in MCP"})})]}),"\n",(0,i.jsxs)(n.p,{children:["We talked about this issue back in August 2025: ",(0,i.jsx)(n.a,{href:"https://rebelion.la/agent-tools-guardrails-why-too-many-tools-can-break-your-ai",children:"why too many tools can break your AI"}),", and now it\u2019s time to get practical. This is the moment where MCP moves from \u201ccool demo tech\u201d to ",(0,i.jsx)(n.strong,{children:"real platform engineering"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"If you don\u2019t solve token bloat early, your MCP will become:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Expensive to run"}),"\n",(0,i.jsx)(n.li,{children:"Slow to reason"}),"\n",(0,i.jsx)(n.li,{children:"Hard to govern"}),"\n",(0,i.jsx)(n.li,{children:"Risky for enterprise compliance"}),"\n",(0,i.jsx)(n.li,{children:"Hallucination-prone"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Let\u2019s break down what\u2019s happening \u2014 and how to design MCP systems that scale cleanly."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"token-bloat-in-mcp-why-your-tool-catalog-is-becoming-a-cost-latency-and-security-problem",children:"Token Bloat in MCP: Why Your Tool Catalog Is Becoming a Cost, Latency, and Security Problem"}),"\n",(0,i.jsx)(n.h3,{id:"business-impact-first",children:"Business impact first"}),"\n",(0,i.jsx)(n.p,{children:"Token bloat creates some immediate problems:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Problem"}),(0,i.jsx)(n.th,{children:"Business Impact"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Cost explosion"}),(0,i.jsx)(n.td,{children:"Every request loads thousands of unused tool schemas"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Latency"}),(0,i.jsx)(n.td,{children:"Larger prompts = slower inference"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Reasoning degradation"}),(0,i.jsx)(n.td,{children:"LLMs perform worse with noisy context"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Security risk"}),(0,i.jsx)(n.td,{children:"Tools leak into contexts they should never be in"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Compliance failure"}),(0,i.jsx)(n.td,{children:"Shadow tools get injected into AI workflows"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["At enterprise scale, token bloat is not a technical issue.\nIt\u2019s a ",(0,i.jsx)(n.strong,{children:"platform liability"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"what-is-token-bloat-in-mcp",children:"What Is Token Bloat in MCP?"}),"\n",(0,i.jsx)(n.h4,{id:"simple-definition",children:"Simple definition"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Token bloat happens when your MCP client sends too many tool definitions into the model context \u2014 even when only one tool is needed."})}),"\n",(0,i.jsx)(n.p,{children:"Instead of:"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u201cHere is the one tool you need.\u201d"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"You send:"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u201cHere are 4,200 tools. Pick one.\u201d"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Each tool contains:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Name"}),"\n",(0,i.jsx)(n.li,{children:"Description"}),"\n",(0,i.jsx)(n.li,{children:"JSON schema"}),"\n",(0,i.jsx)(n.li,{children:"Input types"}),"\n",(0,i.jsx)(n.li,{children:"Output types"}),"\n",(0,i.jsx)(n.li,{children:"Metadata"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Multiply that by thousands."}),"\n",(0,i.jsx)(n.p,{children:"Now your model prompt is tens of thousands of tokens before reasoning even starts."}),"\n",(0,i.jsx)(n.p,{children:"That\u2019s token bloat."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"why-mcp-is-uniquely-vulnerable",children:"Why MCP Is Uniquely Vulnerable?"}),"\n",(0,i.jsx)(n.p,{children:"MCP is powerful because it standardizes tools."}),"\n",(0,i.jsx)(n.p,{children:"But that same power creates a new failure mode:"}),"\n",(0,i.jsx)(n.h4,{id:"mcp-encourages-tool-catalogs",children:"MCP encourages tool catalogs"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Public registries"}),"\n",(0,i.jsx)(n.li,{children:"Internal enterprise registries"}),"\n",(0,i.jsx)(n.li,{children:"Department registries"}),"\n",(0,i.jsx)(n.li,{children:"Vendor registries"}),"\n",(0,i.jsx)(n.li,{children:"Marketplace registries"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Soon you have:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"CRM tools"}),"\n",(0,i.jsx)(n.li,{children:"ERP tools"}),"\n",(0,i.jsx)(n.li,{children:"Cloud tools"}),"\n",(0,i.jsx)(n.li,{children:"DevOps tools"}),"\n",(0,i.jsx)(n.li,{children:"Security tools"}),"\n",(0,i.jsx)(n.li,{children:"Finance tools"}),"\n",(0,i.jsx)(n.li,{children:"HR tools"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"All MCP-compatible."}),"\n",(0,i.jsx)(n.p,{children:"Now your agent needs to choose one."}),"\n",(0,i.jsxs)(n.p,{children:["So na\xefve implementations load ",(0,i.jsx)(n.strong,{children:"everything"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"the-breaking-point-thousands-of-tools",children:"The Breaking Point: Thousands of Tools"}),"\n",(0,i.jsx)(n.p,{children:"The MCP community hit this wall in 2025."}),"\n",(0,i.jsx)(n.p,{children:"Which led to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"SEP-1576: Mitigating Token Bloat in MCP"})}),"\n",(0,i.jsxs)(n.li,{children:["Feature request: ",(0,i.jsx)(n.strong,{children:"Lazy Loading for MCP Servers"})]}),"\n",(0,i.jsxs)(n.li,{children:["Claude shipping ",(0,i.jsx)(n.strong,{children:"Tool Search Tool"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This is the signal:"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"The ecosystem is moving from static tool injection to dynamic discovery."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"claudes-tool-search-tool-the-new-mcp-pattern",children:"Claude\u2019s Tool Search Tool: The New MCP Pattern"}),"\n",(0,i.jsxs)(n.p,{children:["Claude\u2019s new ",(0,i.jsx)(n.strong,{children:"Tool Search Tool"})," introduces an important shift."]}),"\n",(0,i.jsx)(n.p,{children:"Instead of loading all tools into context:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Claude receives a task"}),"\n",(0,i.jsx)(n.li,{children:"Claude searches a tool registry"}),"\n",(0,i.jsx)(n.li,{children:"Claude selects relevant tools"}),"\n",(0,i.jsx)(n.li,{children:"Only those tools are loaded into context"}),"\n",(0,i.jsx)(n.li,{children:"Execution begins"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This mirrors how real software works:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"You don\u2019t load every library"}),"\n",(0,i.jsx)(n.li,{children:"You import what you need"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This is the path to the future of MCP."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"the-core-mcp-scaling-problem",children:"The Core MCP Scaling Problem"}),"\n",(0,i.jsx)(n.p,{children:"Let\u2019s formalize it."}),"\n",(0,i.jsx)(n.p,{children:"Your MCP system has four layers:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"User \u2192 Agent \u2192 MCP Client \u2192 MCP Registry \u2192 MCP Servers\n"})}),"\n",(0,i.jsx)(n.p,{children:"The failure happens at:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"MCP Client \u2192 Model Context\n"})}),"\n",(0,i.jsx)(n.p,{children:"Where:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The MCP client injects tool schemas"}),"\n",(0,i.jsx)(n.li,{children:"The model must reason over them"}),"\n",(0,i.jsx)(n.li,{children:"The prompt explodes"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"sep-1576-the-communitys-wake-up-call",children:"SEP-1576: The Community\u2019s Wake-Up Call"}),"\n",(0,i.jsx)(n.p,{children:"SEP-1576 proposes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Lazy tool loading"}),"\n",(0,i.jsx)(n.li,{children:"Partial schemas"}),"\n",(0,i.jsx)(n.li,{children:"Tool summaries"}),"\n",(0,i.jsx)(n.li,{children:"On-demand expansion"}),"\n",(0,i.jsx)(n.li,{children:"Context budgets"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"It acknowledges a core truth:"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["MCP systems must become ",(0,i.jsx)(n.strong,{children:"context-aware platforms"}),", not dumb tool injectors."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"why-token-bloat-breaks-ai-reasoning",children:"Why Token Bloat Breaks AI Reasoning"}),"\n",(0,i.jsx)(n.p,{children:"LLMs do not reason better with more tools."}),"\n",(0,i.jsx)(n.p,{children:"They reason better with:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Clear options"}),"\n",(0,i.jsx)(n.li,{children:"Minimal noise"}),"\n",(0,i.jsx)(n.li,{children:"Focused schemas"}),"\n",(0,i.jsx)(n.li,{children:"Small decision trees"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Token bloat causes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Tool confusion"}),"\n",(0,i.jsx)(n.li,{children:"Hallucinated tool calls"}),"\n",(0,i.jsx)(n.li,{children:"Slower planning"}),"\n",(0,i.jsx)(n.li,{children:"Lower accuracy"}),"\n",(0,i.jsx)(n.li,{children:"Higher cost"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This is not theoretical.\nThis is measurable."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"mcp-needs-platform-architecture--not-just-protocols",children:"MCP Needs Platform Architecture \u2014 Not Just Protocols"}),"\n",(0,i.jsx)(n.p,{children:"This is where most teams fail."}),"\n",(0,i.jsx)(n.p,{children:"They treat MCP like:"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u201cJust expose APIs as tools.\u201d"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["But MCP is not just transport.\nIt is an ",(0,i.jsx)(n.strong,{children:"AI execution platform"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"You need:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Tool governance"}),"\n",(0,i.jsx)(n.li,{children:"Context orchestration"}),"\n",(0,i.jsx)(n.li,{children:"Discovery"}),"\n",(0,i.jsx)(n.li,{children:"Authorization"}),"\n",(0,i.jsx)(n.li,{children:"Policy"}),"\n",(0,i.jsx)(n.li,{children:"Auditing"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["This is why naive MCP deployments become ",(0,i.jsx)(n.strong,{children:"Shadow MCP"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"shadow-mcp-the-silent-compliance-risk",children:"Shadow MCP: The Silent Compliance Risk"}),"\n",(0,i.jsx)(n.p,{children:"Shadow MCP is when:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Teams spin up MCP servers ad-hoc"}),"\n",(0,i.jsx)(n.li,{children:"No registry"}),"\n",(0,i.jsx)(n.li,{children:"No governance"}),"\n",(0,i.jsx)(n.li,{children:"No audit"}),"\n",(0,i.jsx)(n.li,{children:"No access control"}),"\n",(0,i.jsx)(n.li,{children:"No policy"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Now tools silently enter AI contexts."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"This is Shadow IT \u2014 but for AI."})}),"\n",(0,i.jsx)(n.p,{children:"Token bloat is often the first symptom."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"best-practices-for-token-efficient-mcp-design",children:"Best Practices for Token-Efficient MCP Design"}),"\n",(0,i.jsx)(n.p,{children:"Let\u2019s get practical. Here are nine best practices to scale MCP tool catalogs without destroying your budget:"}),"\n",(0,i.jsx)(n.h3,{id:"1-never-load-all-tools",children:"1. Never Load All Tools"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Rule:"}),"\nNo MCP client should ever inject all tools into context."]}),"\n",(0,i.jsx)(n.p,{children:"Ever."}),"\n",(0,i.jsx)(n.p,{children:"Use:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Search"}),"\n",(0,i.jsx)(n.li,{children:"Discovery"}),"\n",(0,i.jsx)(n.li,{children:"Ranking"}),"\n",(0,i.jsx)(n.li,{children:"Filtering"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"2-implement-tool-discovery",children:"2. Implement Tool Discovery"}),"\n",(0,i.jsx)(n.p,{children:"Your agent should:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Understand the task"}),"\n",(0,i.jsx)(n.li,{children:"Query a registry"}),"\n",(0,i.jsx)(n.li,{children:"Receive ranked candidates"}),"\n",(0,i.jsx)(n.li,{children:"Load only relevant tools"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This is exactly what Claude\u2019s Tool Search Tool enables."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"3-use-tool-summaries-first",children:"3. Use Tool Summaries First"}),"\n",(0,i.jsx)(n.p,{children:"Instead of loading full schemas:"}),"\n",(0,i.jsx)(n.p,{children:"Start with:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Name"}),"\n",(0,i.jsx)(n.li,{children:"Description"}),"\n",(0,i.jsx)(n.li,{children:"Capability tags"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Then expand only the chosen tool."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"4-enforce-context-budgets",children:"4. Enforce Context Budgets"}),"\n",(0,i.jsx)(n.p,{children:"Define:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Max tool count per request"}),"\n",(0,i.jsx)(n.li,{children:"Max schema tokens"}),"\n",(0,i.jsx)(n.li,{children:"Max metadata size"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Reject or paginate when limits are exceeded."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"5-add-policy-based-tool-filtering",children:"5. Add Policy-Based Tool Filtering"}),"\n",(0,i.jsx)(n.p,{children:"Not every agent should see every tool."}),"\n",(0,i.jsx)(n.p,{children:"Filter by:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Role"}),"\n",(0,i.jsx)(n.li,{children:"Tenant"}),"\n",(0,i.jsx)(n.li,{children:"Department"}),"\n",(0,i.jsx)(n.li,{children:"Environment"}),"\n",(0,i.jsx)(n.li,{children:"Compliance level"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"6-add-tool-ranking",children:"6. Add Tool Ranking"}),"\n",(0,i.jsx)(n.p,{children:"Use:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Semantic search"}),"\n",(0,i.jsx)(n.li,{children:"Tags"}),"\n",(0,i.jsx)(n.li,{children:"Domain"}),"\n",(0,i.jsx)(n.li,{children:"Past usage"}),"\n",(0,i.jsx)(n.li,{children:"Cost"}),"\n",(0,i.jsx)(n.li,{children:"Latency"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Return top N candidates only."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"7-add-tool-versioning",children:"7. Add Tool Versioning"}),"\n",(0,i.jsx)(n.p,{children:"Never inject multiple versions of the same tool."}),"\n",(0,i.jsx)(n.p,{children:"Use:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Stable aliases"}),"\n",(0,i.jsx)(n.li,{children:"Deprecation policies"}),"\n",(0,i.jsx)(n.li,{children:"Controlled rollouts"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"8-use-partial-schemas",children:"8. Use Partial Schemas"}),"\n",(0,i.jsx)(n.p,{children:"Load:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Input shape only"}),"\n",(0,i.jsx)(n.li,{children:"Output later"}),"\n",(0,i.jsx)(n.li,{children:"Examples on demand"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"9-add-audit-trails",children:"9. Add Audit Trails"}),"\n",(0,i.jsx)(n.p,{children:"Track:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Tool discovery"}),"\n",(0,i.jsx)(n.li,{children:"Tool selection"}),"\n",(0,i.jsx)(n.li,{children:"Tool execution"}),"\n",(0,i.jsx)(n.li,{children:"Tool failures"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This becomes your AI governance layer."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"mcp-is-becoming-an-ai-operating-system",children:"MCP Is Becoming an AI Operating System"}),"\n",(0,i.jsx)(n.p,{children:"This is the real shift."}),"\n",(0,i.jsx)(n.p,{children:"MCP is no longer:"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u201cA protocol for tools.\u201d"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"It is becoming:"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u201cAn operating system for AI execution.\u201d"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Which means:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Scheduling"}),"\n",(0,i.jsx)(n.li,{children:"Discovery"}),"\n",(0,i.jsx)(n.li,{children:"Security"}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/mcp-registry-connect-authority/",children:"Connect Authority"})}),"\n",(0,i.jsx)(n.li,{children:"Cost control"}),"\n",(0,i.jsx)(n.li,{children:"Governance"}),"\n",(0,i.jsx)(n.li,{children:"Observability"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Token bloat is the first scaling signal."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"where-hapi-mcp-fits-in-this-architecture",children:"Where HAPI MCP Fits in This Architecture"}),"\n",(0,i.jsx)(n.p,{children:"HAPI MCP Stack was designed for exactly this future."}),"\n",(0,i.jsxs)(n.p,{children:["Not as a toy MCP wrapper.\nBut as a ",(0,i.jsx)(n.strong,{children:"Headless API platform for AI execution."})]}),"\n",(0,i.jsx)(n.p,{children:"Core principles:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://hapi.mcp.com.ai/",children:"API-first MCP servers"})}),"\n",(0,i.jsx)(n.li,{children:"Registry-first discovery"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/tags/mcp-connect-authority",children:"Connect Authority"})," enforcement"]}),"\n",(0,i.jsx)(n.li,{children:"Zero-trust architecture"}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.mcp.com.ai/deployment/",children:"Enterprise-grade deployment"})}),"\n",(0,i.jsx)(n.li,{children:"Airgap-ready"}),"\n",(0,i.jsx)(n.li,{children:"Cloud-ready"}),"\n",(0,i.jsx)(n.li,{children:"VM-first friendly"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["HAPI treats ",(0,i.jsxs)(n.a,{href:"https://docs.mcp.com.ai/introduction/architecture",children:["MCP as ",(0,i.jsx)(n.strong,{children:"platform infrastructure"})]}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Not prompt glue."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"the-future-tool-search-lazy-loading-and-ai-gateways",children:"The Future: Tool Search, Lazy Loading, and AI Gateways"}),"\n",(0,i.jsx)(n.p,{children:"We\u2019re entering the next phase of AI platforms:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Old"}),(0,i.jsx)(n.th,{children:"New"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Static tools"}),(0,i.jsx)(n.td,{children:"Dynamic discovery"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Prompt injection"}),(0,i.jsx)(n.td,{children:"Context orchestration"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Manual schemas"}),(0,i.jsx)(n.td,{children:"Search-driven tools"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Flat catalogs"}),(0,i.jsx)(n.td,{children:"Ranked registries"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"No governance"}),(0,i.jsx)(n.td,{children:"Policy enforcement"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Shadow MCP"}),(0,i.jsx)(n.td,{children:"MCP Authority"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["This is exactly the direction Claude is moving.",(0,i.jsx)(n.br,{}),"\n","This is exactly what SEP-1576 proposes.",(0,i.jsx)(n.br,{}),"\n","And this is exactly what enterprises need. HAPI MCP Stack is built for this future."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"final-takeaways-how-to-build-mcp-systems-that-scale",children:"Final Takeaways: How to Build MCP Systems That Scale"}),"\n",(0,i.jsx)(n.p,{children:"If you're building with MCP today, here is your roadmap:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Adopt tool discovery"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Implement lazy loading"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Use a registry"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Add a connect authority"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Enforce context budgets"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Filter by policy"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Rank tools"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Audit everything"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Kill shadow MCP"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Treat MCP as platform infrastructure"})}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"mcp-without-token-discipline-will-fail",children:"MCP Without Token Discipline Will Fail"}),"\n",(0,i.jsx)(n.p,{children:"Token bloat is not a bug.\nIt\u2019s a design failure."}),"\n",(0,i.jsx)(n.p,{children:"The teams that solve it now will own the next generation of AI platforms."}),"\n",(0,i.jsx)(n.p,{children:"The teams that ignore it will build expensive demos that never scale."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"the-question-is-simple",children:"The question is simple:"}),"\n",(0,i.jsx)(n.p,{children:"Are you building MCP tools..."}),"\n",(0,i.jsx)(n.p,{children:"Or are you building an MCP platform?"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:"If you're serious about AI at scale, start designing for token efficiency now."}),"\n",(0,i.jsx)(n.p,{children:"Because your AI is only as smart as the context you give it."}),"\n",(0,i.jsx)(n.p,{children:"Be HAPI, and Go Rebels! \u270a\ud83c\udffc"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"faq-token-bloat-in-mcp",children:"FAQ: Token bloat in MCP"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Q: What is token bloat in MCP?"}),(0,i.jsx)(n.br,{}),"\n","A: Token bloat in MCP happens when an MCP client injects too many tool definitions (schemas + descriptions) into the model context, inflating prompt size before reasoning even starts."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Q: Why is token bloat a problem for MCP systems?"}),(0,i.jsx)(n.br,{}),"\n","A: Token bloat increases cost per request, adds latency, degrades tool selection quality, and expands the security/compliance surface because more tools appear in context than are needed."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Q: What causes token bloat in MCP tool catalogs?"}),(0,i.jsx)(n.br,{}),"\n","A: The most common cause is static tool injection: loading the full tool catalog into the prompt on every request instead of discovering and loading only what\u2019s needed."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Q: What is lazy loading for MCP tools?"}),(0,i.jsx)(n.br,{}),"\n","A: Lazy loading means you load tool schemas only after the agent has identified relevant tools (usually via search/ranking), rather than preloading every tool into context."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Q: What is tool discovery in MCP?"}),(0,i.jsx)(n.br,{}),"\n","A: Tool discovery is a step where the agent queries a registry (or authority layer) to retrieve a small, ranked set of candidate tools for a task, then loads only those."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Q: How do you mitigate token bloat when you have thousands of MCP tools?"}),(0,i.jsx)(n.br,{}),"\n","A: Use search-based discovery + ranking, enforce tool/context budgets, filter tools by policy (role/tenant), and expand schemas on demand (summaries first, full schemas later)."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Q: What is a context budget for MCP tools?"}),(0,i.jsx)(n.br,{}),"\n","A: A context budget is a hard limit on how many tools or schema tokens can be included in a request. It keeps cost and latency predictable and prevents runaway prompts."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Q: Should I use FAQPage or QAPage schema for MCP Q&A content?"}),(0,i.jsx)(n.br,{}),"\n","A: Use FAQPage when each question has a single authoritative answer you provide. Use QAPage only when users can submit answers (like forums)."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Q: What is shadow MCP and how does it relate to token bloat?"}),(0,i.jsx)(n.br,{}),"\n","A: Shadow MCP is ungoverned MCP tooling (servers/tools) that appear without centralized discovery, policy, or audit. It often shows up first as tool sprawl and token bloat."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Q: What\u2019s the best MCP architecture pattern to scale tool catalogs?"}),(0,i.jsx)(n.br,{}),"\n","A: Registry-first discovery with an authority/policy layer: the agent searches a catalog, gets a small ranked shortlist, and only then loads the selected tool schemas for execution."]}),"\n",(0,i.jsx)(n.h2,{id:"references",children:"References:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Feature Request: ",(0,i.jsx)(n.a,{href:"https://github.com/anthropics/claude-code/issues/7336",children:"Lazy Loading"})," for MCP Servers and Tools"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://venturebeat.com/orchestration/claude-code-just-got-updated-with-one-of-the-most-requested-user-features",children:"https://venturebeat.com/orchestration/claude-code-just-got-updated-with-one-of-the-most-requested-user-features"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://platform.claude.com/docs/en/agents-and-tools/tool-use/tool-search-tool",children:"Tool search tool"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://x.com/trq212/status/2011523109871108570",children:"X Post"})," with more details."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/modelcontextprotocol/modelcontextprotocol/issues/1576",children:"SEP-1576: Mitigating Token Bloat in MCP"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(x,{...e})}):x(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>r});var t=s(6540);const i={},o=t.createContext(i);function l(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);